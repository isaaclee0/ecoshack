---
import ImageMod from "@/components/ImageMod.astro";
import { markdownify } from "@/lib/utils/textConverter";
import type { CollectionEntry } from "astro:content";

type Props = {
  gallery: CollectionEntry<"homepage">["data"]["gallery"];
  isNoSectionBottom?: boolean;
};

const { gallery, isNoSectionBottom = false } = Astro.props;
const { enable, title, subtitle, description, images } = gallery;
---

{
  enable && (
    <section class={`section ${isNoSectionBottom && "pb-0"}`}>
      <div class="container">
        <div class="row g-5 justify-between items-center max-lg:text-center">
          <div class="lg:col-4 flex items-center justify-center py-6">
            <div class="company-logo" aria-label="Eco Shack logo" />
          </div>
          <p
            data-aos="fade-up-sm"
            data-aos-delay="300"
            class="lg:col-8 h4 text-primary lg:indent-20 text-center lg:text-left"
            set:html={markdownify(description)}
          />
        </div>
      </div>

      <div class="swiper gallery-slider mt-17.5">
        <div class="swiper-wrapper">
          {images?.map((img, i) => (
            <div class="swiper-slide">
              <ImageMod
                src={img}
                height={256}
                width={196}
                alt={`gallery-slider-${i}`}
                format="webp"
                quality={80}
                loading="lazy"
                widths={[196, 392, 588]}
                sizes="(max-width: 768px) 196px, (max-width: 1024px) 196px, 196px"
                class="w-full h-auto object-cover"
              />
            </div>
          ))}
        </div>
        <div class="mt-9 flex items-center justify-center text-center" />
      </div>
    </section>
  )
}
<style>
  .swiper-wrapper {
    transition-timing-function: linear !important;
  }
  .company-logo {
    width: 560px;
    height: 240px;
    max-width: 100%;
    background-color: #609fa1;
    -webkit-mask-image: url('/images/logo.svg');
    -webkit-mask-repeat: no-repeat;
    -webkit-mask-position: center;
    -webkit-mask-size: contain;
    mask-image: url('/images/logo.svg');
    mask-repeat: no-repeat;
    mask-position: center;
    mask-size: contain;
  }
</style>

<script>
  import { Swiper } from "swiper";
  import { Autoplay } from "swiper/modules";

  // astro:page-load event is fired when the page is loaded
  document.addEventListener("astro:page-load", () => {
    new Swiper(".gallery-slider", {
      modules: [Autoplay],
      spaceBetween: 24,
      loop: true,
      centeredSlides: false,
      speed: 10000,
      autoplay: {
        delay: 0,
      },
      breakpoints: {
        0: {
          slidesPerView: 2,
        },
        768: {
          slidesPerView: 4,
        },
        992: {
          slidesPerView: 5,
        },
        2000: {
          slidesPerView: 6,
        },
      },
    });
  });
</script>
