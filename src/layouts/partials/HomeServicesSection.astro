---
import Button from "@/components/Button.astro";
import ImageMod from "@/components/ImageMod.astro";
import { getSinglePage } from "@/lib/contentParser.astro";
import { markdownify } from "@/lib/utils/textConverter";
const { services } = Astro.props;

// Show all published services on the homepage
const allHomeServices = await getSinglePage("services");
---

{
  services.enable && (
    <section class="section pt-0">
      <div class="container">
        {/* section title   */}
        <div class="row gap-4 justify-center lg:justify-between items-center max-lg:text-center">
          <div class="lg:col-6">
            <p
              data-aos="fade-up-sm"
              data-aos-delay="150"
              class="font-medium text-primary uppercase"
              set:html={markdownify(services.subtitle)}
            />
            <h2
              data-aos="fade-up-sm"
              data-aos-delay="200"
              class="mt-3 font-medium text-primary"
              set:html={markdownify(services.title)}
            />
          </div>

          {services.button.enable && (
            <div
              data-aos="fade-up-sm"
              data-aos-delay="300"
              class="lg:col-4 flex flex-col items-center lg:items-end mt-6 lg:mt-auto"
            >
              <Button {...services.button} />
            </div>
          )}
        </div>

        {/* services cards  */}
        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-10 xl:gap-24 pt-10 md:pt-40 px-4 sm:px-10 lg:px-0 overflow-hidden max-md:w-[90%] mx-auto">
          {allHomeServices?.map((service, index) => (
            <div class="flex flex-col md:h-[550px] justify-end mb-24 last:mb-0">
              <div class="flex justify-center items-end md:h-[400px]">
                <ImageMod
                  src={service.data.gallery_images && service.data.gallery_images.length > 0 ? service.data.gallery_images[0] : service.data.image!}
                  alt={service.data.title}
                  width={600}
                  height={500}
                  format="webp"
                  quality={85}
                  loading="eager"
                  widths={[400, 600, 800, 1200]}
                  sizes="(max-width: 768px) 90vw, (max-width: 1024px) 45vw, 33vw"
                  class={`${
                    index % 3 === 1
                      ? "h-[500px] object-cover w-full"
                      : "h-[410px] object-cover w-full self-end"
                  }`}
                />
              </div>

              <div class="mt-10 text-center">
                <h3
                  class="h5 font-medium mb-2"
                  set:html={markdownify(service.data.title)}
                />
                <p set:html={markdownify(service.data.description)} />
              </div>
            </div>
          ))}
        </div>
      </div>
    </section>
  )
}

<!-- Swiper disabled for services section to avoid visibility issues -->

<!-- No Swiper initialization; static images only to ensure stability -->
